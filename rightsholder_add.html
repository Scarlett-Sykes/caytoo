<div id="thankYouMessage" style="display:none; background-color: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 10px; width: 800px; margin: 0 auto 50px auto; box-shadow: 0 0 10px rgba(0,0,0,0.2); text-align: center; font-weight: bold;"></div>

<script>
  document.getElementById('myForm').addEventListener('submit', async function (e) {
    e.preventDefault();

    const form = e.target;
    const thankYouDiv = document.getElementById('thankYouMessage');
    thankYouDiv.style.display = 'none';  // Hide message at start

    const formData = new FormData(form);
    formData.set('unique_id', generateCustomUniqueId());

    const data = {};
    for (const [key, value] of formData.entries()) {
      if (data[key]) {
        data[key] = Array.isArray(data[key]) ? [...data[key], value] : [data[key], value];
      } else {
        data[key] = value;
      }
    }

    try {
      const response = await fetch('http://localhost:5678/webhook-test/form-input', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      if (response.ok) {
        form.reset();
        thankYouDiv.style.color = 'green';
        thankYouDiv.textContent = "✅ Thank you! That Rightsholder processed fine.";
        thankYouDiv.style.display = 'block';
      } else {
        thankYouDiv.style.color = 'red';
        thankYouDiv.textContent = "❌ Sorry, there was an error processing the Rightsholder. Check if they are on Apollo.";
        thankYouDiv.style.display = 'block';
      }
    } catch (error) {
      console.error('Form submission error:', error);
      thankYouDiv.style.color = 'red';
      thankYouDiv.textContent = "❌ Submission failed. Please check your connection and try again.";
      thankYouDiv.style.display = 'block';
    }
  });
</script>
